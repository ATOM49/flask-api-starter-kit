# Flask Api Starter Kit

[![CircleCI](https://circleci.com/gh/antkahn/flask-api-starter-kit/tree/master.svg?style=svg)](https://circleci.com/gh/antkahn/flask-api-starter-kit/tree/master)

This starter kit is designed to allow you to create very fast your Flask API.

The primary goal of this project is to remain as **unopinionated** as possible. Its purpose is not to dictate your project structure or to demonstrate a complete sample application, but to provide a set of tools intended to make back-end development robust, easy, and, most importantly, fun.

## Table of Contents
1. [Dependencies](#dependencies)
1. [Getting Started](#getting-started)
1. [Commands](#commands)
1. [Application Structure](#application-structure)
1. [Development](#development)
1. [Testing](#testing)
1. [Deployment](#deployment)

## Dependencies

You will need [docker](https://docs.docker.com/engine/installation/), [docker-compose](https://docs.docker.com/compose/install/) and [npm](https://docs.npmjs.com/getting-started/installing-node).

## Getting Started

First, clone the project:

```bash
$ git clone https://github.com/antkahn/flask-api-starter-kit.git <my-project-name>
$ cd <my-project-name>
```

Then install dependencies and check to see it works

```bash
$ npm run server:install      # Install the pip dependencies on the docker container
$ npm run server:run          # Run the container containing your local python server
```
If everything works, you should see the routes [here](http://127.0.0.1:3000/application/routes).

## Commands

While developing, you will probably rely mostly on `npm run server:run`; however, there are additional scripts at your disposal:

|`npm run <script>`|Description|
|------------------|-----------|
|`server:install`|Install the pip dependencies on the server's container.|
|`server:run`|Run your local server on it's own docker container.|
|`server:daemon`|Run your local server on it's own docker container as a daemon.|
|`bdd:connect`|Connects you to your local database.|
|`bdd:migrate`|Generate a database migration file using alembic, based on your models file.|
|`bdd:upgrade`|Run the migrations until your database is up to date.|
|`bdd:downgrade`|Downgrade your database of the last migration run.|
|`test`|Runs unit tests with unittest on it's own container.|
|`lint`|Run pep8 and flake8 and the `src` directory.|
|`deploy:prod`|Deploys your code on your server using shipit.|
|`rollback:prod`|Rollback your last deployment on the server using shipit.|

## Application Structure

The application structure presented in this boilerplate is grouped primarily by file type. Please note, however, that this structure is only meant to serve as a guide, it is by no means prescriptive.

```
.
├── devops                   # Project devops configuration settings
│   └── deploy               # Environment-specific configuration files for shipit
├── migrations               # Database's migrations settings
│   └── versions             # Database's migrations versions generated by alembic
├── src                      # Application source code
│   ├── models               # Python classes modeling the database
│   │   └── abc.py           # Abstract base class model
│   ├── repositories         # Python classes allowing you to interact with your models
│   ├── resources            # Python classes containing the HTTP verbs of your routes
│   ├── routes               # Routes definitions and link to their associated resources
│   │   ├── __init__.py      # Contains every blueprint of your API
│   │   └── routes.py        # The routes blueprint exposing your routes and HTTP verbs
│   ├── util                 # Python functions to be used in your project
│   │   └── parse_params.py  # Wrapper for the resources to easily handle parameters
│   ├── config.py            # Project configuration settings
│   ├── manage.py            # Project commands
│   └── server.py            # Server configuration
└── test                     # Unit tests
```

## Development

To develop locally, here are your two options:

```bash
$ npm run server:run           # Create the containers containing your python server in your terminal
$ npm run server:daemon        # Create the containers containing your python server as a daemon
```

The containers will adapt by themselves as your source code is changed.
You can check the logs in the `./server.log` file.

## Testing
To add a unit test, simply create a `test_*.py` file anywhere in `~/test`, prefix your test classes with `Test` and your test methods with `test_`. Unittest will run them automaticaly.
You can add objects in your database that will only be used in your tests, see example.
You can run your tests in their own container with the command:

```bash
$ npm run test
```

## Deployment
Out of the box, this starter kit is deployable using shipit. Simply change the configuration lines in the `./shipit.js` file.
